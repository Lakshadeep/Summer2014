Final version of the arduino code.